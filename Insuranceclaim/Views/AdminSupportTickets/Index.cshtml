@model IEnumerable<Insuranceclaim.Models.SupportTicket>
 
@{

    Layout = "~/Views/Shared/_AdminLayout.cshtml";

    ViewData["Title"] = "Support Tickets";

}
 
<style>

    /* Your existing CSS for the index page */

    .support-ticket-container {

        display: flex;

        flex-direction: column;

        gap: 20px;

        margin-top: 20px;

    }
 
    .ticket-card {

        background-color: #ffffff;

        padding: 20px;

        border-radius: 8px;

        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);

        display: flex;

        flex-direction: column;

        justify-content: space-between;

    }
 
    .ticket-header {

        display: flex;

        justify-content: space-between;

        align-items: center;

        margin-bottom: 10px;

    }
 
    .ticket-header h4 {

        margin: 0;

        font-weight: 600;

        color: #333;

    }
 
    .ticket-header .status-resolved {

        background-color: #d4edda;

        color: #155724;

        padding: 5px 10px;

        border-radius: 5px;

    }
 
    .ticket-header .status-inprogress,

    .ticket-header .status-pending {

        background-color: #fff3cd;

        color: #856404;

        padding: 5px 10px;

        border-radius: 5px;

    }

    .status-open {

        background-color: #f8d7da;

        color: #721c24;

        padding: 5px 10px;

        border-radius: 5px;

    }
 
    .ticket-info p {

        margin: 5px 0;

        font-size: 0.95rem;

        color: #555;

    }
 
    .ticket-info strong {

        color: #333;

    }
 
    .view-details-btn {

        align-self: flex-end;

    }

    .filter-section {

        margin-bottom: 20px;

    }
</style>
 
<div class="main-content">
<div class="d-flex justify-content-between align-items-center mt-4 mb-4">
<h2>Support Tickets</h2>
</div>
 
    @* The fix for the filtering glitch *@

 
    <div class="support-ticket-container">

        @if (Model.Any())

        {

            @foreach (var ticket in Model)

            {
<div class="ticket-card">
<div class="ticket-header">

                        {{-- Added logic for "Open" status --}}
<span class="status-badge @(ticket.TicketStatus?.ToLower().Replace(" ", "") == "resolved" ? "status-resolved" : ticket.TicketStatus?.ToLower().Replace(" ", "") == "inprogress" ? "status-inprogress" : "status-open")">

                            Status: @ticket.TicketStatus
</span>
</div>
<div class="ticket-info">

                        {{-- This line is correct, the issue is data-related --}}
<p><strong>Username:</strong> @ticket.User?.Username</p>
<p><strong>Created:</strong> @ticket.CreatedDate?.ToString("dd/MM/yyyy")</p>
<p><strong>Description:</strong> @ticket.IssueDescription</p>
</div>
<div class="view-details-btn">
<a asp-controller="AdminSupportTickets" asp-action="Details" asp-route-id="@ticket.TicketId" class="btn btn-primary">View Details</a>
</div>
</div>

            }

        }

        else

        {
<div class="alert alert-info text-center">

                No support tickets found for the selected status.
</div>

        }
</div>
</div>
 